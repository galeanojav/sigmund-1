
bp(1,1) = 0.000001;
bp(2,1) = 0.000012;
bp(3,1) = 0.000012;
bp(4,1) = 0.000006;
bp(5,1) = 0.00001;

bp(1,2) = 0.000012;
bp(2,2) = 0.000004;
bp(3,2) = 0.00001;
bp(4,2) = 0;
bp(5,2) = 0;

bp(1,3) = 0.000012;
bp(2,3) = 0.000011;
bp(3,3) = 0;
bp(4,3) = 0;
bp(5,3) = 0;

bp(1,4) = 0.000016;
bp(2,4) = 0.0000;
bp(3,4) = 0;
bp(4,4) = 0;
bp(5,4) = 0;


%{
bp(1,1) = 0.001;
bp(2,1) = 0;
bp(3,1) = 0;
bp(4,1) = 0;
bp(5,1) = 0;

bp(1,2) = 0;
bp(2,2) = 0;
bp(3,2) = 0;
bp(4,2) = 0;
bp(5,2) = 0;

bp(1,3) = 0;
bp(2,3) = 0;
bp(3,3) = 0;
bp(4,3) = 0;
bp(5,3) = 0;

bp(1,4) = 0;
bp(2,4) = 0;
bp(3,4) = 0;
bp(4,4) = 0;
bp(5,4) = 0;
%}

cp(1) = 0.0001;
cp(2) = 0.0001;
cp(3) = 0.0001;
cp(4) = 0.0001;
alphap(1) = 0.000007;
alphap(2) = 0.000012;
alphap(3) = 0.000012;
alphap(4) = 0.00001;
rp(1)=0.004-0.005;
rp(2)=0.01-0.04;
rp(3)=0.01-0.05;
rp(4)=0.005-0.0055;

%rp(2)=0;rp(3)=0;rp(4)=0;
%alphap(2)=0;alphap(3)=0;alphap(4)=0;


ba(1,1)= 0.000014;
ba(2,1)= 0.000012;
ba(3,1)= 0.000002;
ba(4,1)= 0.00001;

ba(1,2)= 0.000013;
ba(2,2)= 0.000006;
ba(3,2)= 0.000005;
ba(4,2)= 0.000001;

ba(1,3)= 0.00001;
ba(2,3)= 0.000001;
ba(3,3)= 0.000001;
ba(4,3)= 0;

ba(1,4)= 0.00001;
ba(2,4)= 0.00001;
ba(3,4)= 0;
ba(4,4)= 0;

ba(1,5)= 0.00002;
ba(2,5)= 0;
ba(3,5)= 0;
ba(4,5)= 0;

%{
ba(1,1)= 0.000014;
ba(2,1)= 0;
ba(3,1)= 0;
ba(4,1)= 0;

ba(1,2)= 0;
ba(2,2)= 0;
ba(3,2)= 0;
ba(4,2)= 0;

ba(1,3)= 0;
ba(2,3)= 0;
ba(3,3)= 0;
ba(4,3)= 0;

ba(1,4)= 0;
ba(2,4)= 0;
ba(3,4)= 0;
ba(4,4)= 0;

ba(1,5)= 0;
ba(2,5)= 0;
ba(3,5)= 0;
ba(4,5)= 0;
%}

ca(1) = 0.0001;
ca(2) = 0.0001;
ca(3) = 0.0001;
ca(4) = 0.0001;
ca(5) = 0.0001;

alphaa(1)=0.00001;
alphaa(2)=0.00001;
alphaa(3)=0.000008;
alphaa(4)=0.00001;
alphaa(5)=0.00003;

ra(1)=0.028-0.044;
ra(2)=0.02-0.058;
ra(3)=0.05-0.065;
ra(4)=0.02-0.034;
ra(5)=0.02-0.038;

%ra(2)=0;ra(3)=0;ra(4)=0;ra(5)=0;
%alphaa(2)=0;alphaa(3)=0;alphaa(4)=0;alphaa(5)=0;

B = [-alphap(1) 0 0 0 bp(1,1) bp(2,1) bp(3,1) bp(4,1) bp(5,1);
     0 -alphap(2) 0 0 bp(1,2) bp(2,2) bp(3,2) bp(4,2) bp(5,2);
     0 0 -alphap(3) 0 bp(1,3) bp(2,3) bp(3,3) bp(4,3) bp(5,3);
     0 0 0 -alphap(4) bp(1,4) bp(2,4) bp(3,4) bp(4,4) bp(5,4);
     ba(1,1) ba(2,1) ba(3,1) ba(4,1) -alphaa(1) 0 0 0 0;
     ba(1,2) ba(2,2) ba(3,2) ba(4,2) 0 -alphaa(2) 0 0 0;
     ba(1,3) ba(2,3) ba(3,3) ba(4,3) 0 0 -alphaa(3) 0 0;
     ba(1,4) ba(2,4) ba(3,4) ba(4,4) 0 0 0 -alphaa(4) 0;
     ba(1,5) ba(2,5) ba(3,5) ba(4,5) 0 0 0 0 -alphaa(5)];
m = [-rp(1);-rp(2);-rp(3);-rp(4);-ra(1);-ra(2);-ra(3);-ra(4);-ra(5)]; 
gxmin = linsolve(B,m)

for i=1:length(gxmin)
    if (gxmin(i)<0)
        gxmin(i)=0;
    end
end

G=10;

x0=gxmin;
inda = 4;
bmp=zeros(4);
bma=zeros(5);
%
%for i=1:4
%  bmp(i)= bp(1,i)*x(1+inda)+bp(2,i)*x(2+inda)+bp(3,i)*x(3+inda)+bp(4,i)*x(4+inda)+bp(5,i)*x(5+inda);
%end;
%for i=1:5
%   bma(i)= ba(1,i)*x(1)+ba(2,i)*x(2)+ba(3,i)*x(3)+ba(4,i)*x(4);
%end
%

f2 =@(x) [rp(1)+bp(1,1)*x(1+inda)+bp(2,1)*x(2+inda)+bp(3,1)*x(3+inda)+bp(4,1)*x(4+inda)+bp(5,1)*x(5+inda)-x(1)*(alphap(1)+cp(1)*(bp(1,1)*x(1+inda)+bp(2,1)*x(2+inda)+bp(3,1)*x(3+inda)+bp(4,1)*x(4+inda)+bp(5,1)*x(5+inda)));
         rp(2)+bp(1,2)*x(1+inda)+bp(2,2)*x(2+inda)+bp(3,2)*x(3+inda)+bp(4,2)*x(4+inda)+bp(5,2)*x(5+inda)-x(2)*(alphap(2)+cp(2)*(bp(1,2)*x(1+inda)+bp(2,2)*x(2+inda)+bp(3,2)*x(3+inda)+bp(4,2)*x(4+inda)+bp(5,2)*x(5+inda)));
         rp(3)+bp(1,3)*x(1+inda)+bp(2,3)*x(2+inda)+bp(3,3)*x(3+inda)+bp(4,3)*x(4+inda)+bp(5,3)*x(5+inda)-x(3)*(alphap(3)+cp(3)*(bp(1,3)*x(1+inda)+bp(2,3)*x(2+inda)+bp(3,3)*x(3+inda)+bp(4,3)*x(4+inda)+bp(5,3)*x(5+inda)));
         rp(4)+bp(1,4)*x(1+inda)+bp(2,4)*x(2+inda)+bp(3,4)*x(3+inda)+bp(4,4)*x(4+inda)+bp(5,4)*x(5+inda)-x(4)*(alphap(4)+cp(4)*(bp(1,4)*x(1+inda)+bp(2,4)*x(2+inda)+bp(3,4)*x(3+inda)+bp(4,4)*x(4+inda)+bp(5,4)*x(5+inda)));
         ra(1)+ba(1,1)*x(1)+ba(2,1)*x(2)+ba(3,1)*x(3)+ba(4,1)*x(4)-x(1+inda)*(alphaa(1)+ca(1)*(ba(1,1)*x(1)+ba(2,1)*x(2)+ba(3,1)*x(3)+ba(4,1)*x(4)));
         ra(2)+ba(1,2)*x(1)+ba(2,2)*x(2)+ba(3,2)*x(3)+ba(4,2)*x(4)-x(2+inda)*(alphaa(2)+ca(2)*(ba(1,2)*x(1)+ba(2,2)*x(2)+ba(3,2)*x(3)+ba(4,2)*x(4)));
         ra(3)+ba(1,3)*x(1)+ba(2,3)*x(2)+ba(3,3)*x(3)+ba(4,3)*x(4)-x(3+inda)*(alphaa(3)+ca(3)*(ba(1,3)*x(1)+ba(2,3)*x(2)+ba(3,3)*x(3)+ba(4,3)*x(4)));
         ra(4)+ba(1,4)*x(1)+ba(2,4)*x(2)+ba(3,4)*x(3)+ba(4,4)*x(4)-x(4+inda)*(alphaa(4)+ca(4)*(ba(1,4)*x(1)+ba(2,4)*x(2)+ba(3,4)*x(3)+ba(4,4)*x(4)));
         ra(5)+ba(1,5)*x(1)+ba(2,5)*x(2)+ba(3,5)*x(3)+ba(4,5)*x(4)-x(5+inda)*(alphaa(5)+ca(5)*(ba(1,5)*x(1)+ba(2,5)*x(2)+ba(3,5)*x(3)+ba(4,5)*x(4)))];
          
f = @(x)[G*f2(x)];

x0 = gxmin;
xmin = fsolve(f,x0)

%x0=[1/cp(1);1/cp(2);1/cp(3);1/cp(4);1/ca(1);1/ca(2);1/ca(3);1/ca(4);1/ca(5)];
x0=[1/cp(1);0;0;0;1/ca(1);0;0;0;0];

xmax = fsolve(f,x0)